{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .boat-carousel-section {
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 25%, #2d2d2d 50%, #1a1a1a 75%, #0a0a0a 100%);
    padding: 60px 0;
    margin: 20px 0;
    position: relative;
  }

  .boat-carousel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 40px;
    padding: 0 40px;
  }

  .boat-carousel-title {
    color: white;
    font-size: clamp(1.5rem, 3vw, 2.5rem);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    margin: 0;
  }

  .boat-view-all {
    color: #d9232d;
    text-decoration: none;
    font-weight: 600;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
  }

  .boat-view-all:hover {
    color: #ff4757;
    transform: translateX(5px);
  }

  .boat-products-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 20px;
    padding: 0 40px;
    max-width: 1400px;
    margin: 0 auto;
  }

  .boat-product-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 16px;
    padding: 16px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
    min-height: 380px;
    display: flex;
    flex-direction: column;
  }

  .boat-product-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15), 0 0 30px rgba(217, 35, 45, 0.1);
  }

  .boat-product-image-container {
    position: relative;
    margin-bottom: 12px;
  }

  .boat-product-image {
    width: 100%;
    height: 160px;
    object-fit: cover;
    border-radius: 12px;
    transition: transform 0.3s ease;
  }

  .boat-product-card:hover .boat-product-image {
    transform: scale(1.05);
  }

  /* Badge Styles */
  .boat-product-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 2;
  }

  .boat-badge-new-launch {
    background: linear-gradient(45deg, #000000, #333333);
    color: white;
  }

  .boat-badge-trending {
    background: linear-gradient(45deg, #ff6b35, #ff8c42);
    color: white;
  }

  .boat-badge-engraving {
    background: linear-gradient(45deg, #8b5cf6, #a855f7);
    color: white;
  }

  .boat-badge-extra-off {
    background: linear-gradient(45deg, #10b981, #059669);
    color: white;
  }

  /* Spec Display */
  .boat-product-spec {
    position: absolute;
    bottom: 8px;
    left: 8px;
    background: rgba(255, 255, 255, 0.9);
    color: #333;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 600;
    backdrop-filter: blur(5px);
  }

  .boat-product-info {
    color: #333;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .boat-product-title {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1a1a1a;
    line-height: 1.3;
    flex-grow: 1;
  }

  /* Color Swatches */
  .boat-color-swatches {
    display: flex;
    gap: 4px;
    margin-bottom: 8px;
    align-items: center;
  }

  .boat-color-swatch {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  .boat-color-swatch:hover {
    transform: scale(1.2);
  }

  .boat-color-swatch.active {
    transform: scale(1.2);
    box-shadow: 0 0 0 2px #d9232d;
  }

  .boat-color-count {
    font-size: 12px;
    color: #666;
    margin-left: 4px;
  }

  /* Rating */
  .boat-product-rating {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
  }

  .boat-rating-stars {
    color: #fbbf24;
    font-size: 12px;
  }

  .boat-rating-number {
    background: #10b981;
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
  }

  .boat-product-price {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
  }

  .boat-current-price {
    font-size: 18px;
    font-weight: 700;
    color: #1a1a1a;
  }

  .boat-original-price {
    font-size: 13px;
    color: #888;
    text-decoration: line-through;
  }

  .boat-discount-percent {
    background: linear-gradient(45d, #10b981, #059669);
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
  }

  .boat-add-to-cart {
    width: 100%;
    background: linear-gradient(45deg, #d9232d, #ff4757);
    color: white;
    border: none;
    padding: 10px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 12px;
    margin-top: auto;
  }

  .boat-add-to-cart:hover {
    background: linear-gradient(45deg, #b71c1c, #d9232d);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(217, 35, 45, 0.3);
  }

  /* Responsive Design */
  @media screen and (max-width: 1200px) {
    .boat-products-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  @media screen and (max-width: 989px) {
    .boat-products-grid {
      grid-template-columns: repeat(3, 1fr);
      padding: 0 20px;
    }

    .boat-carousel-header {
      padding: 0 20px;
      flex-direction: column;
      gap: 15px;
      text-align: center;
    }
  }

  @media screen and (max-width: 749px) {
    .boat-products-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }

    .boat-product-card {
      padding: 12px;
      min-height: 320px;
    }

    .boat-product-image {
      height: 140px;
    }
  }

  @media screen and (max-width: 549px) {
    .boat-products-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .boat-product-image {
      height: 120px;
    }
  }
{%- endstyle -%}

<div class="boat-carousel-section">
  <div class="boat-carousel-header">
    {%- if section.settings.title != blank -%}
      <h2 class="boat-carousel-title">{{ section.settings.title }}</h2>
    {%- endif -%}

    {%- if section.settings.collection != blank and section.settings.show_view_all -%}
      <a href="{{ collections[section.settings.collection].url }}" class="boat-view-all">
        {{ section.settings.view_all_text | default: 'View All' }} âŠ•
      </a>
    {%- endif -%}
  </div>

  <div class="boat-products-grid">
    {%- liquid
      assign collection = collections[section.settings.collection]
      if collection == blank
        assign collection = collections.all
      endif

      assign products_to_show = section.settings.products_to_show | default: 6
      assign badge_types = 'new-launch,trending,engraving,extra-off' | split: ','
      assign badge_labels = 'New Launch,ðŸ”¥ Trending,âš¡ Engraving Available,ðŸ’š EXTRA â‚¹100 OFF' | split: ','
      assign specs = '50 Hours Playback,20 Hours Playback,40 Hours Playback,BT Calling,12 Hours Playback,10000mAh Battery' | split: ','
    -%}

    {%- for product in collection.products limit: products_to_show -%}
      {%- assign random_badge = forloop.index0 | modulo: 4 -%}
      {%- assign random_spec = forloop.index0 | modulo: 6 -%}
      {%- assign random_rating = '4.6,4.9,4.8,5.0,4.8,5.0' | split: ',' -%}
      {%- assign product_rating = random_rating[forloop.index0] | default: '4.8' -%}

      <div class="boat-product-card">
        <div class="boat-product-image-container">
          {%- comment -%} Product Badge {%- endcomment -%}
          <div class="boat-product-badge boat-badge-{{ badge_types[random_badge] }}">
            {{ badge_labels[random_badge] }}
          </div>

          {%- comment -%} Product Spec {%- endcomment -%}
          <div class="boat-product-spec">
            {{ specs[random_spec] }}
          </div>

          <a href="{{ product.url }}">
            <img
              src="{{ product.featured_image | image_url: width: 400 }}"
              alt="{{ product.featured_image.alt | escape }}"
              class="boat-product-image"
              width="400"
              height="400"
            >
          </a>
        </div>

        <div class="boat-product-info">
          <h3 class="boat-product-title">
            <a href="{{ product.url }}">{{ product.title }}</a>
          </h3>

          {%- comment -%} Color Swatches {%- endcomment -%}
          {%- if product.options contains 'Color' -%}
            <div class="boat-color-swatches">
              {%- assign color_count = 0 -%}
              {%- for option in product.options -%}
                {%- if option == 'Color' -%}
                  {%- assign color_values = product.option_by_name[option].values -%}
                  {%- assign color_count = color_values.size -%}
                  {%- for color in color_values limit: 3 -%}
                    {%- assign color_lower = color | downcase -%}
                    {%- assign color_hex = '#000000' -%}
                    {%- case color_lower -%}
                      {%- when 'black' -%}
                        {%- assign color_hex = '#000000' -%}
                      {%- when 'blue' -%}
                        {%- assign color_hex = '#3b82f6' -%}
                      {%- when 'green' -%}
                        {%- assign color_hex = '#10b981' -%}
                      {%- when 'red' -%}
                        {%- assign color_hex = '#ef4444' -%}
                      {%- when 'white' -%}
                        {%- assign color_hex = '#ffffff' -%}
                      {%- when 'gray', 'grey' -%}
                        {%- assign color_hex = '#6b7280' -%}
                      {%- else -%}
                        {%- assign color_hex = '#8b5cf6' -%}
                    {%- endcase -%}
                    <div
                      class="boat-color-swatch{% if forloop.first %} active{% endif %}"
                      style="background-color: {{ color_hex }};"
                    ></div>
                  {%- endfor -%}
                  {%- if color_count > 3 -%}
                    <span class="boat-color-count">+{{ color_count | minus: 3 }}</span>
                  {%- endif -%}
                {%- endif -%}
              {%- endfor -%}
            </div>
          {%- else -%}
            {%- comment -%} Default color swatches if no color option {%- endcomment -%}
            <div class="boat-color-swatches">
              <div class="boat-color-swatch active" style="background-color: #000000;"></div>
              <div class="boat-color-swatch" style="background-color: #3b82f6;"></div>
              <span class="boat-color-count">+{{ forloop.index | modulo: 3 | plus: 1 }}</span>
            </div>
          {%- endif -%}

          {%- comment -%} Rating {%- endcomment -%}
          <div class="boat-product-rating">
            <div class="boat-rating-stars">â˜…</div>
            <div class="boat-rating-number">{{ product_rating }}</div>
          </div>

          <div class="boat-product-price">
            <span class="boat-current-price">{{ product.price | money }}</span>
            {%- if product.compare_at_price > product.price -%}
              <span class="boat-original-price">{{ product.compare_at_price | money }}</span>
              {%- assign discount = product.compare_at_price
                | minus: product.price
                | times: 100.0
                | divided_by: product.compare_at_price
                | round
              -%}
              <span class="boat-discount-percent">{{ discount }}% off</span>
            {%- endif -%}
          </div>

          <form action="/cart/add" method="post" enctype="multipart/form-data">
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
            <button type="submit" class="boat-add-to-cart">Add to Cart</button>
          </form>
        </div>
      </div>
    {%- endfor -%}
  </div>
</div>

{% schema %}
{
  "name": "boAt Product Carousel",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Sale Is Live"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "label": "Products to show",
      "default": 6
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show view all link",
      "default": true
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View all text",
      "default": "View All"
    }
  ],
  "presets": [
    {
      "name": "boAt Product Carousel"
    }
  ]
}
{% endschema %}
